{"version":3,"sources":["light_dom_spec.js"],"names":[],"mappings":"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","file":"angular2/test/render/dom/shadow_dom/light_dom_spec.es6","sourcesContent":["import {describe, beforeEach, it, expect, ddescribe, iit, SpyObject, el, proxy} from 'angular2/test_lib';\nimport {IMPLEMENTS, isBlank, isPresent} from 'angular2/src/facade/lang';\nimport {ListWrapper, MapWrapper} from 'angular2/src/facade/collection';\nimport {DOM} from 'angular2/src/dom/dom_adapter';\nimport {Content} from 'angular2/src/render/dom/shadow_dom/content_tag';\nimport {LightDom} from 'angular2/src/render/dom/shadow_dom/light_dom';\nimport {RenderView} from 'angular2/src/render/dom/view/view';\nimport {ViewContainer} from 'angular2/src/render/dom/view/view_container';\n\n@proxy\n@IMPLEMENTS(RenderView)\nclass FakeView {\n  contentTags;\n  viewContainers;\n\n  constructor(containers = null) {\n    this.contentTags = [];\n    this.viewContainers = [];\n    if (isPresent(containers)) {\n      ListWrapper.forEach(containers, (c) => {\n        if (c instanceof FakeContentTag) {\n          ListWrapper.push(this.contentTags, c);\n        } else {\n          ListWrapper.push(this.contentTags, null);\n        }\n        if (c instanceof FakeViewContainer) {\n          ListWrapper.push(this.viewContainers, c);\n        } else {\n          ListWrapper.push(this.viewContainers, null);\n        }\n      });\n    }\n  }\n\n  noSuchMethod(i) {\n    super.noSuchMethod(i);\n  }\n}\n\n@proxy\n@IMPLEMENTS(ViewContainer)\nclass FakeViewContainer {\n  templateElement;\n  _nodes;\n  _contentTagContainers;\n\n  constructor(templateEl, nodes = null, views = null) {\n    this.templateElement = templateEl;\n    this._nodes = nodes;\n    this._contentTagContainers = views;\n  }\n\n  nodes(){\n    return this._nodes;\n  }\n\n  contentTagContainers(){\n    return this._contentTagContainers;\n  }\n\n  noSuchMethod(i) {\n    super.noSuchMethod(i);\n  }\n}\n\n\n@proxy\n@IMPLEMENTS(Content)\nclass FakeContentTag {\n  select;\n  _nodes;\n  contentStartElement;\n\n  constructor(contentEl, select = '', nodes = null) {\n    this.contentStartElement = contentEl;\n    this.select = select;\n    this._nodes = nodes;\n  }\n\n  insert(nodes){\n    this._nodes = ListWrapper.clone(nodes);\n  }\n\n  nodes() {\n    return this._nodes;\n  }\n\n  noSuchMethod(i) {\n    super.noSuchMethod(i);\n  }\n}\n\n\nexport function main() {\n  describe('LightDom', function() {\n    var lightDomView;\n\n    beforeEach(() => {\n      lightDomView = new FakeView();\n    });\n\n    describe(\"contentTags\", () => {\n      it(\"should collect content tags from element injectors\", () => {\n        var tag = new FakeContentTag(el('<script></script>'));\n        var shadowDomView = new FakeView([tag]);\n\n        var lightDom = new LightDom(lightDomView, shadowDomView,\n            el(\"<div></div>\"));\n\n        expect(lightDom.contentTags()).toEqual([tag]);\n      });\n\n      it(\"should collect content tags from ViewContainers\", () => {\n        var tag = new FakeContentTag(el('<script></script>'));\n        var vc = new FakeViewContainer(null, null, [\n          new FakeView([tag])\n        ]);\n        var shadowDomView = new FakeView([vc]);\n        var lightDom = new LightDom(lightDomView, shadowDomView,\n            el(\"<div></div>\"));\n\n        expect(lightDom.contentTags()).toEqual([tag]);\n      });\n    });\n\n    describe(\"expandedDomNodes\", () => {\n      it(\"should contain root nodes\", () => {\n        var lightDomEl = el(\"<div><a></a></div>\")\n        var lightDom = new LightDom(lightDomView, new FakeView(), lightDomEl);\n        expect(toHtml(lightDom.expandedDomNodes())).toEqual([\"<a></a>\"]);\n      });\n\n      it(\"should include view container nodes\", () => {\n        var lightDomEl = el(\"<div><template></template></div>\");\n        var lightDom = new LightDom(\n          new FakeView([\n            new FakeViewContainer(\n              DOM.firstChild(lightDomEl),  // template element\n              [el('<a></a>')]              // light DOM nodes of view container\n            )\n          ]),\n          null,\n          lightDomEl);\n\n        expect(toHtml(lightDom.expandedDomNodes())).toEqual([\"<a></a>\"]);\n      });\n\n      it(\"should include content nodes\", () => {\n        var lightDomEl = el(\"<div><content></content></div>\");\n        var lightDom = new LightDom(\n          new FakeView([\n            new FakeContentTag(\n              DOM.firstChild(lightDomEl),  // content element\n              '',                          // selector\n              [el('<a></a>')]              // light DOM nodes of content tag\n            )\n          ]),\n          null,\n          lightDomEl);\n\n        expect(toHtml(lightDom.expandedDomNodes())).toEqual([\"<a></a>\"]);\n      });\n\n      it(\"should work when the element injector array contains nulls\", () => {\n        var lightDomEl = el(\"<div><a></a></div>\")\n\n        var lightDomView = new FakeView();\n\n        var lightDom = new LightDom(\n          lightDomView,\n          new FakeView(),\n          lightDomEl);\n\n        expect(toHtml(lightDom.expandedDomNodes())).toEqual([\"<a></a>\"]);\n      });\n    });\n\n    describe(\"redistribute\", () => {\n      it(\"should redistribute nodes between content tags with select property set\", () => {\n        var contentA = new FakeContentTag(null, \"a\");\n        var contentB = new FakeContentTag(null, \"b\");\n\n        var lightDomEl = el(\"<div><a>1</a><b>2</b><a>3</a></div>\")\n\n        var lightDom = new LightDom(lightDomView, new FakeView([\n          contentA,\n          contentB\n        ]), lightDomEl);\n\n        lightDom.redistribute();\n\n        expect(toHtml(contentA.nodes())).toEqual([\"<a>1</a>\", \"<a>3</a>\"]);\n        expect(toHtml(contentB.nodes())).toEqual([\"<b>2</b>\"]);\n      });\n\n      it(\"should support wildcard content tags\", () => {\n        var wildcard = new FakeContentTag(null, '');\n        var contentB = new FakeContentTag(null, \"b\");\n\n        var lightDomEl = el(\"<div><a>1</a><b>2</b><a>3</a></div>\")\n\n        var lightDom = new LightDom(lightDomView, new FakeView([\n          wildcard,\n          contentB\n        ]), lightDomEl);\n\n        lightDom.redistribute();\n\n        expect(toHtml(wildcard.nodes())).toEqual([\"<a>1</a>\", \"<b>2</b>\", \"<a>3</a>\"]);\n        expect(toHtml(contentB.nodes())).toEqual([]);\n      });\n    });\n  });\n}\n\nfunction toHtml(nodes) {\n  if (isBlank(nodes)) return [];\n  return ListWrapper.map(nodes, DOM.getOuterHTML);\n}\n"]}