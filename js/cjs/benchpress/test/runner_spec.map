{"version":3,"sources":["runner_spec.js"],"names":[],"mappings":"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","file":"benchpress/test/runner_spec.js","sourcesContent":["import {\n  afterEach,\n  AsyncTestCompleter,\n  beforeEach,\n  ddescribe,\n  describe,\n  expect,\n  iit,\n  inject,\n  it,\n  xit,\n} from 'angular2/test_lib';\nimport {\n  Runner, Sampler, SampleDescription,\n  Validator, bind, Injector, Metric,\n  Options, WebDriverAdapter\n} from 'benchpress/common';\nimport { isBlank } from 'angular2/src/facade/lang';\nimport { Promise, PromiseWrapper } from 'angular2/src/facade/async';\n\nexport function main() {\n  describe('runner', () => {\n    var injector;\n    var runner;\n\n    function createRunner(defaultBindings = null) {\n      if (isBlank(defaultBindings)) {\n        defaultBindings = [];\n      }\n      runner = new Runner([\n        defaultBindings,\n        bind(Sampler).toFactory(\n          (_injector) => {\n            injector = _injector;\n            return new MockSampler();\n          }, [Injector]\n        ),\n        bind(Metric).toFactory( () => new MockMetric(), []),\n        bind(Validator).toFactory( () => new MockValidator(), []),\n        bind(WebDriverAdapter).toFactory( () => new MockWebDriverAdapter(), [])\n      ]);\n      return runner;\n    }\n\n    it('should set SampleDescription.id', inject([AsyncTestCompleter], (async) => {\n      createRunner().sample({id: 'someId'})\n        .then( (_) => injector.asyncGet(SampleDescription) )\n        .then( (desc) => {\n          expect(desc.id).toBe('someId');\n          async.done();\n        });\n    }));\n\n    it('should merge SampleDescription.description', inject([AsyncTestCompleter], (async) => {\n      createRunner([\n        bind(Options.DEFAULT_DESCRIPTION).toValue({'a': 1})\n      ]).sample({id: 'someId', bindings: [\n        bind(Options.SAMPLE_DESCRIPTION).toValue({'b': 2})\n      ]}).then( (_) => injector.asyncGet(SampleDescription) )\n         .then( (desc) => {\n\n        expect(desc.description).toEqual({\n          'forceGc': false,\n          'userAgent': 'someUserAgent',\n          'a': 1,\n          'b': 2,\n          'v': 11\n        });\n        async.done();\n      });\n    }));\n\n    it('should fill SampleDescription.metrics from the Metric', inject([AsyncTestCompleter], (async) => {\n      createRunner().sample({id: 'someId'})\n        .then( (_) => injector.asyncGet(SampleDescription) )\n        .then( (desc) => {\n\n        expect(desc.metrics).toEqual({ 'm1': 'some metric' });\n        async.done();\n      });\n    }));\n\n    it('should bind Options.EXECUTE', inject([AsyncTestCompleter], (async) => {\n      var execute = () => {};\n      createRunner().sample({id: 'someId', execute: execute}).then( (_) => {\n        expect(injector.get(Options.EXECUTE)).toEqual(execute);\n        async.done();\n      });\n    }));\n\n    it('should bind Options.PREPARE', inject([AsyncTestCompleter], (async) => {\n      var prepare = () => {};\n      createRunner().sample({id: 'someId', prepare: prepare}).then( (_) => {\n        expect(injector.get(Options.PREPARE)).toEqual(prepare);\n        async.done();\n      });\n    }));\n\n    it('should bind Options.MICRO_METRICS', inject([AsyncTestCompleter], (async) => {\n      createRunner().sample({id: 'someId', microMetrics: {'a': 'b'}}).then( (_) => {\n        expect(injector.get(Options.MICRO_METRICS)).toEqual({'a': 'b'});\n        async.done();\n      });\n    }));\n\n    it('should overwrite bindings per sample call', inject([AsyncTestCompleter], (async) => {\n      createRunner([\n        bind(Options.DEFAULT_DESCRIPTION).toValue({'a': 1}),\n      ]).sample({id: 'someId', bindings: [\n        bind(Options.DEFAULT_DESCRIPTION).toValue({'a': 2}),\n      ]}).then( (_) => injector.asyncGet(SampleDescription) )\n         .then( (desc) => {\n\n        expect(injector.get(SampleDescription).description['a']).toBe(2);\n        async.done();\n      });\n\n    }));\n\n  });\n}\n\nclass MockWebDriverAdapter extends WebDriverAdapter {\n  executeScript(script):Promise {\n    return PromiseWrapper.resolve('someUserAgent');\n  }\n}\n\nclass MockValidator extends Validator {\n  constructor() {\n    super();\n  }\n  describe() {\n    return { 'v': 11 };\n  }\n}\n\nclass MockMetric extends Metric {\n  constructor() {\n    super();\n  }\n  describe() {\n    return { 'm1': 'some metric' };\n  }\n}\n\nclass MockSampler extends Sampler {\n  constructor() {\n    super();\n  }\n  sample():Promise {\n    return PromiseWrapper.resolve(23);\n  }\n}\n"]}