{"version":3,"sources":["sampler_spec.js"],"names":[],"mappings":"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","file":"benchpress/test/sampler_spec.js","sourcesContent":["import {\n  afterEach,\n  AsyncTestCompleter,\n  beforeEach,\n  ddescribe,\n  describe,\n  expect,\n  iit,\n  inject,\n  it,\n  xit,\n} from 'angular2/test_lib';\n\nimport { isBlank, isPresent, BaseException, stringify, Date, DateWrapper } from 'angular2/src/facade/lang';\nimport { ListWrapper, List } from 'angular2/src/facade/collection';\nimport { PromiseWrapper, Promise } from 'angular2/src/facade/async';\n\nimport {\n  Sampler, WebDriverAdapter, WebDriverExtension,\n  Validator, Metric, Reporter, Browser,\n  bind, Injector, Options, MeasureValues\n} from 'benchpress/common';\n\nexport function main() {\n  var EMPTY_EXECUTE = () => {};\n\n  describe('sampler', () => {\n    var sampler;\n\n    function createSampler({\n      driver,\n      driverExtension,\n      metric,\n      reporter,\n      validator,\n      forceGc,\n      prepare,\n      execute\n    } = {}) {\n      var time = 1000;\n      if (isBlank(metric)) {\n        metric = new MockMetric([]);\n      }\n      if (isBlank(reporter)) {\n        reporter = new MockReporter([]);\n      }\n      if (isBlank(driver)) {\n        driver = new MockDriverAdapter([]);\n      }\n      if (isBlank(driverExtension)) {\n        driverExtension = new MockDriverExtension([]);\n      }\n      var bindings = [\n        Options.DEFAULT_BINDINGS,\n        Sampler.BINDINGS,\n        bind(Metric).toValue(metric),\n        bind(Reporter).toValue(reporter),\n        bind(WebDriverAdapter).toValue(driver),\n        bind(WebDriverExtension).toValue(driverExtension),\n        bind(Options.EXECUTE).toValue(execute),\n        bind(Validator).toValue(validator),\n        bind(Options.NOW).toValue( () => DateWrapper.fromMillis(time++) )\n      ];\n      if (isPresent(prepare)) {\n        ListWrapper.push(bindings, bind(Options.PREPARE).toValue(prepare));\n      }\n      if (isPresent(forceGc)) {\n        ListWrapper.push(bindings, bind(Options.FORCE_GC).toValue(forceGc));\n      }\n\n      sampler = Injector.resolveAndCreate(bindings).get(Sampler);\n    }\n\n    it('should call the prepare and execute callbacks using WebDriverAdapter.waitFor', inject([AsyncTestCompleter], (async) => {\n      var log = [];\n      var count = 0;\n      var driver = new MockDriverAdapter([], (callback) => {\n        var result = callback();\n        ListWrapper.push(log, result);\n        return PromiseWrapper.resolve(result);\n      });\n      createSampler({\n        driver: driver,\n        validator: createCountingValidator(2),\n        prepare: () => {\n          return count++;\n        },\n        execute: () => {\n          return count++;\n        }\n      });\n      sampler.sample().then( (_) => {\n        expect(count).toBe(4);\n        expect(log).toEqual([0,1,2,3]);\n        async.done();\n      });\n\n    }));\n\n    it('should call prepare, gc, beginMeasure, execute, gc, endMeasure for every iteration', inject([AsyncTestCompleter], (async) => {\n      var workCount = 0;\n      var log = [];\n      createSampler({\n        forceGc: true,\n        metric: createCountingMetric(log),\n        driverExtension: new MockDriverExtension(log),\n        validator: createCountingValidator(2),\n        prepare: () => {\n          ListWrapper.push(log, `p${workCount++}`);\n        },\n        execute: () => {\n          ListWrapper.push(log, `w${workCount++}`);\n        }\n      });\n      sampler.sample().then( (_) => {\n        expect(log).toEqual([\n          ['gc'],\n          'p0',\n          ['gc'],\n          ['beginMeasure'],\n          'w1',\n          ['gc'],\n          ['endMeasure', false, {'script': 0}],\n          'p2',\n          ['gc'],\n          ['beginMeasure'],\n          'w3',\n          ['gc'],\n          ['endMeasure', false, {'script': 1}],\n        ]);\n        async.done();\n      });\n    }));\n\n    it('should call execute, gc, endMeasure for every iteration if there is no prepare callback', inject([AsyncTestCompleter], (async) => {\n      var log = [];\n      var workCount = 0;\n      createSampler({\n        forceGc: true,\n        metric: createCountingMetric(log),\n        driverExtension: new MockDriverExtension(log),\n        validator: createCountingValidator(2),\n        execute: () => {\n          ListWrapper.push(log, `w${workCount++}`);\n        },\n        prepare: null\n      });\n      sampler.sample().then( (_) => {\n        expect(log).toEqual([\n          ['gc'],\n          ['beginMeasure'],\n          'w0',\n          ['gc'],\n          ['endMeasure', true, {'script': 0}],\n          'w1',\n          ['gc'],\n          ['endMeasure', true, {'script': 1}],\n        ]);\n        async.done();\n      });\n    }));\n\n    it('should not gc if the flag is not set', inject([AsyncTestCompleter], (async) => {\n      var log = [];\n      createSampler({\n        metric: createCountingMetric(),\n        driverExtension: new MockDriverExtension(log),\n        validator: createCountingValidator(2),\n        prepare: EMPTY_EXECUTE,\n        execute: EMPTY_EXECUTE\n      });\n      sampler.sample().then( (_) => {\n        expect(log).toEqual([]);\n        async.done();\n      });\n    }));\n\n    it('should only collect metrics for execute and ignore metrics from prepare', inject([AsyncTestCompleter], (async) => {\n      var scriptTime = 0;\n      var iterationCount = 1;\n      createSampler({\n        validator: createCountingValidator(2),\n        metric: new MockMetric([], () => {\n          var result = PromiseWrapper.resolve({'script': scriptTime});\n          scriptTime = 0;\n          return result;\n        }),\n        prepare: () => {\n          scriptTime = 1 * iterationCount;\n        },\n        execute: () => {\n          scriptTime = 10 * iterationCount;\n          iterationCount++;\n        }\n      });\n      sampler.sample().then( (state) => {\n        expect(state.completeSample.length).toBe(2);\n        expect(state.completeSample[0]).toEqual(mv(0, 1000, {'script': 10}));\n        expect(state.completeSample[1]).toEqual(mv(1, 1001, {'script': 20}));\n        async.done();\n      });\n    }));\n\n    it('should call the validator for every execution and store the valid sample', inject([AsyncTestCompleter], (async) => {\n      var log = [];\n      var validSample = [{}];\n\n      createSampler({\n        metric: createCountingMetric(),\n        validator: createCountingValidator(2, validSample, log),\n        execute: EMPTY_EXECUTE\n      });\n      sampler.sample().then( (state) => {\n        expect(state.validSample).toBe(validSample);\n        // TODO(tbosch): Why does this fail??\n        // expect(log).toEqual([\n        //   ['validate', [{'script': 0}], null],\n        //   ['validate', [{'script': 0}, {'script': 1}], validSample]\n        // ]);\n\n        expect(log.length).toBe(2);\n        expect(log[0]).toEqual(\n          ['validate', [mv(0, 1000, {'script': 0})], null]\n        );\n        expect(log[1]).toEqual(\n          ['validate', [mv(0, 1000, {'script': 0}), mv(1, 1001, {'script': 1})], validSample]\n        );\n\n        async.done();\n      });\n    }));\n\n    it('should report the metric values', inject([AsyncTestCompleter], (async) => {\n      var log = [];\n      var validSample = [{}];\n      createSampler({\n        validator: createCountingValidator(2, validSample),\n        metric: createCountingMetric(),\n        reporter: new MockReporter(log),\n        execute: EMPTY_EXECUTE\n      });\n      sampler.sample().then( (_) => {\n        // TODO(tbosch): Why does this fail??\n        // expect(log).toEqual([\n        //   ['reportMeasureValues', 0, {'script': 0}],\n        //   ['reportMeasureValues', 1, {'script': 1}],\n        //   ['reportSample', [{'script': 0}, {'script': 1}], validSample]\n        // ]);\n        expect(log.length).toBe(3);\n        expect(log[0]).toEqual(\n          ['reportMeasureValues', mv(0, 1000, {'script': 0})]\n        );\n        expect(log[1]).toEqual(\n          ['reportMeasureValues', mv(1, 1001, {'script': 1})]\n        );\n        expect(log[2]).toEqual(\n          ['reportSample', [mv(0, 1000, {'script': 0}), mv(1, 1001, {'script': 1})], validSample]\n        );\n\n        async.done();\n      });\n    }));\n\n  });\n}\n\nfunction mv(runIndex, time, values) {\n  return new MeasureValues(runIndex, DateWrapper.fromMillis(time), values);\n}\n\nfunction createCountingValidator(count, validSample = null, log = null) {\n  return new MockValidator(log, (completeSample) => {\n    count--;\n    if (count === 0) {\n      return isPresent(validSample) ? validSample : completeSample;\n    } else {\n      return null;\n    }\n  });\n}\n\nfunction createCountingMetric(log = null) {\n  var scriptTime = 0;\n  return new MockMetric(log, () => {\n    return { 'script': scriptTime++ };\n  });\n}\n\nclass MockDriverAdapter extends WebDriverAdapter {\n  _log:List;\n  _waitFor:Function;\n  constructor(log = null, waitFor = null) {\n    super();\n    if (isBlank(log)) {\n      log = [];\n    }\n    this._log = log;\n    this._waitFor = waitFor;\n  }\n  waitFor(callback:Function):Promise {\n    if (isPresent(this._waitFor)) {\n      return this._waitFor(callback);\n    } else {\n      return PromiseWrapper.resolve(callback());\n    }\n  }\n}\n\n\nclass MockDriverExtension extends WebDriverExtension {\n  _log:List;\n  constructor(log = null) {\n    super();\n    if (isBlank(log)) {\n      log = [];\n    }\n    this._log = log;\n  }\n  gc():Promise {\n    ListWrapper.push(this._log, ['gc']);\n    return PromiseWrapper.resolve(null);\n  }\n}\n\nclass MockValidator extends Validator {\n  _validate:Function;\n  _log:List;\n  constructor(log = null, validate = null) {\n    super();\n    this._validate = validate;\n    if (isBlank(log)) {\n      log = [];\n    }\n    this._log = log;\n  }\n  validate(completeSample:List<MeasureValues>):List<MeasureValues> {\n    var stableSample = isPresent(this._validate) ? this._validate(completeSample) : completeSample;\n    ListWrapper.push(this._log, ['validate', completeSample, stableSample]);\n    return stableSample;\n  }\n}\n\nclass MockMetric extends Metric {\n  _endMeasure:Function;\n  _log:List;\n  constructor(log = null, endMeasure = null) {\n    super();\n    this._endMeasure = endMeasure;\n    if (isBlank(log)) {\n      log = [];\n    }\n    this._log = log;\n  }\n  beginMeasure() {\n    ListWrapper.push(this._log, ['beginMeasure']);\n    return PromiseWrapper.resolve(null);\n  }\n  endMeasure(restart) {\n    var measureValues = isPresent(this._endMeasure) ? this._endMeasure() : {};\n    ListWrapper.push(this._log, ['endMeasure', restart, measureValues]);\n    return PromiseWrapper.resolve(measureValues);\n  }\n}\n\nclass MockReporter extends Reporter {\n  _log:List;\n  constructor(log = null) {\n    super();\n    if (isBlank(log)) {\n      log = [];\n    }\n    this._log = log;\n  }\n  reportMeasureValues(values):Promise {\n    ListWrapper.push(this._log, ['reportMeasureValues', values]);\n    return PromiseWrapper.resolve(null);\n  }\n  reportSample(completeSample, validSample):Promise {\n    ListWrapper.push(this._log, ['reportSample', completeSample, validSample]);\n    return PromiseWrapper.resolve(null);\n  }\n}\n"]}