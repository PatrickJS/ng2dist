{"version":3,"sources":["change_detection.js"],"names":[],"mappings":"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","file":"angular2/src/change_detection/change_detection.js","sourcesContent":["import {DynamicProtoChangeDetector, JitProtoChangeDetector} from './proto_change_detector';\nimport {PipeRegistry} from './pipes/pipe_registry';\nimport {IterableChangesFactory} from './pipes/iterable_changes';\nimport {KeyValueChangesFactory} from './pipes/keyvalue_changes';\nimport {NullPipeFactory} from './pipes/null_pipe';\nimport {DEFAULT} from './constants';\nimport {ChangeDetection, ProtoChangeDetector} from './interfaces';\nimport {Pipe, NO_CHANGE} from './pipes/pipe';\n\nclass AsyncPipe extends Pipe {\n  observable;\n  subscription;\n  latestValue;\n  latestReturnedValue;\n\n  constructor() {\n    super();\n    this.observable = null;\n    this.latestValue = null;\n  }\n\n  supports(obj) {\n    return this.observable === obj;\n  }\n\n  onDestroy() {\n    this.subscription.dispose();\n  }\n\n  transform(value) {\n    // we need to change the API to move it into the constructor\n    if (! this.subscription) {\n      this.observable = value;\n      this.subscription = value.subscribe(\n        (x) => {this.latestValue = x;},\n        (e) => {throw e;} // zones will create a long stack trace\n      );\n    }\n\n    if (this.latestReturnedValue !== this.latestValue) {\n      this.latestReturnedValue = this.latestValue;\n      return this.latestValue;\n\n    } else {\n      return NO_CHANGE;\n    }\n  }\n}\n\nexport var defaultPipes = {\n  \"iterableDiff\" : [\n    new IterableChangesFactory(),\n    new NullPipeFactory()\n  ],\n  \"keyValDiff\" : [\n    new KeyValueChangesFactory(),\n    new NullPipeFactory()\n  ],\n  \"async\":  [\n    {\n      supports: (obj) => obj.subscribe !== undefined,\n      create: () => new AsyncPipe()\n    }\n  ]\n};\n\nexport class DynamicChangeDetection extends ChangeDetection {\n  registry:PipeRegistry;\n\n  constructor(registry:PipeRegistry) {\n    super();\n    this.registry = registry;\n  }\n\n  createProtoChangeDetector(name:string, changeControlStrategy:string = DEFAULT):ProtoChangeDetector{\n    return new DynamicProtoChangeDetector(this.registry, changeControlStrategy);\n  }\n}\n\nexport class JitChangeDetection extends ChangeDetection {\n  registry:PipeRegistry;\n\n  constructor(registry:PipeRegistry) {\n    super();\n    this.registry = registry;\n  }\n\n  createProtoChangeDetector(name:string, changeControlStrategy:string = DEFAULT):ProtoChangeDetector{\n    return new JitProtoChangeDetector(this.registry, changeControlStrategy);\n  }\n}\n\nvar _registry = new PipeRegistry(defaultPipes);\n\n/**\n * Implements dynamic change detection. See: [ChangeDetection] for more details.\n *\n * @exportedAs angular2/change_detection\n */\nexport var dynamicChangeDetection = new DynamicChangeDetection(_registry);\n\n/**\n * Implements just-in-time change detection. See: [ChangeDetection] for more details.\n *\n * @exportedAs angular2/change_detection\n */\nexport var jitChangeDetection = new JitChangeDetection(_registry);\n"]}