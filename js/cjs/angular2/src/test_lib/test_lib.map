{"version":3,"sources":["test_lib.es6"],"names":[],"mappings":"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","file":"angular2/src/test_lib/test_lib.js","sourcesContent":["import {DOM} from 'angular2/src/dom/dom_adapter';\n\nimport {bind} from 'angular2/di';\n\nimport {createTestInjector, FunctionWithParamTokens, inject} from './test_injector';\n\nexport {inject} from './test_injector';\n\nexport {proxy} from 'rtts_assert/rtts_assert';\n\nvar _global = typeof window === 'undefined' ? global : window;\n\nexport var afterEach = _global.afterEach;\nexport var expect = _global.expect;\n\nexport var IS_DARTIUM = false;\n\nexport class AsyncTestCompleter {\n  _done: Function;\n\n  constructor(done: Function) {\n    this._done = done;\n  }\n\n  done() {\n    this._done();\n  }\n}\n\nvar jsmBeforeEach = _global.beforeEach;\nvar jsmDescribe = _global.describe;\nvar jsmDDescribe = _global.ddescribe;\nvar jsmXDescribe = _global.xdescribe;\nvar jsmIt = _global.it;\nvar jsmIIt = _global.iit;\nvar jsmXIt = _global.xit;\n\nvar runnerStack = [];\nvar inIt = false;\n\nvar testBindings;\n\nclass BeforeEachRunner {\n  constructor(parent: BeforeEachRunner) {\n    this._fns = [];\n    this._parent = parent;\n  }\n\n  beforeEach(fn: FunctionWithParamTokens) {\n    this._fns.push(fn);\n  }\n\n  run(injector) {\n    if (this._parent) this._parent.run();\n    this._fns.forEach((fn) => fn.execute(injector));\n  }\n}\n\n// Reset the test bindings before each test\njsmBeforeEach(() => { testBindings = []; });\n\nfunction _describe(jsmFn, ...args) {\n  var parentRunner = runnerStack.length === 0 ? null : runnerStack[runnerStack.length - 1];\n  var runner = new BeforeEachRunner(parentRunner);\n  runnerStack.push(runner);\n  var suite = jsmFn(...args);\n  runnerStack.pop();\n  return suite;\n}\n\nexport function describe(...args) {\n  return _describe(jsmDescribe, ...args);\n}\n\nexport function ddescribe(...args) {\n  return _describe(jsmDDescribe, ...args);\n}\n\nexport function xdescribe(...args) {\n  return _describe(jsmXDescribe, ...args);\n}\n\nexport function beforeEach(fn) {\n  if (runnerStack.length > 0) {\n    // Inside a describe block, beforeEach() uses a BeforeEachRunner\n    var runner = runnerStack[runnerStack.length - 1];\n    if (!(fn instanceof FunctionWithParamTokens)) {\n      fn = inject([], fn);\n    }\n    runner.beforeEach(fn);\n  } else {\n    // Top level beforeEach() are delegated to jasmine\n    jsmBeforeEach(fn);\n  }\n}\n\n/**\n * Allows overriding default bindings defined in test_injector.js.\n *\n * The given function must return a list of DI bindings.\n *\n * Example:\n *\n *   beforeEachBindings(() => [\n *     bind(Compiler).toClass(MockCompiler),\n *     bind(SomeToken).toValue(myValue),\n *   ]);\n */\nexport function beforeEachBindings(fn) {\n  jsmBeforeEach(() => {\n    var bindings = fn();\n    if (!bindings) return;\n    testBindings = [...testBindings, ...bindings];\n  });\n}\n\nfunction _it(jsmFn, name, fn) {\n  var runner = runnerStack[runnerStack.length - 1];\n\n  jsmFn(name, function(done) {\n    var async = false;\n\n    var completerBinding = bind(AsyncTestCompleter).toFactory(() => {\n      // Mark the test as async when an AsyncTestCompleter is injected in an it()\n      if (!inIt) throw new Error('AsyncTestCompleter can only be injected in an \"it()\"');\n      async = true;\n      return new AsyncTestCompleter(done);\n    });\n\n    var injector = createTestInjector([...testBindings, completerBinding]);\n\n    runner.run(injector);\n\n    if (!(fn instanceof FunctionWithParamTokens)) {\n      fn = inject([], fn);\n    }\n    inIt = true;\n    fn.execute(injector);\n    inIt = false;\n\n    if (!async) done();\n  });\n}\n\nexport function it(name, fn) {\n  return _it(jsmIt, name, fn);\n}\n\nexport function xit(name, fn) {\n  return _it(jsmXIt, name, fn);\n}\n\nexport function iit(name, fn) {\n  return _it(jsmIIt, name, fn);\n}\n\n// To make testing consistent between dart and js\n_global.print = function(msg) {\n  if (_global.dump) {\n    _global.dump(msg);\n  } else {\n    _global.console.log(msg);\n  }\n};\n\n// Some Map polyfills don't polyfill Map.toString correctly, which\n// gives us bad error messages in tests.\n// The only way to do this in Jasmine is to monkey patch a method\n// to the object :-(\n_global.Map.prototype.jasmineToString = function() {\n  var m = this;\n  if (!m) {\n    return ''+m;\n  }\n  var res = [];\n  m.forEach( (v,k) => {\n    res.push(`${k}:${v}`);\n  });\n  return `{ ${res.join(',')} }`;\n}\n\n_global.beforeEach(function() {\n  jasmine.addMatchers({\n    // Custom handler for Map as Jasmine does not support it yet\n    toEqual: function(util, customEqualityTesters) {\n      return {\n        compare: function(actual, expected) {\n          return {\n            pass: util.equals(actual, expected, [compareMap])\n          };\n        }\n      };\n\n      function compareMap(actual, expected) {\n        if (actual instanceof Map) {\n          var pass = actual.size === expected.size;\n          if (pass) {\n            actual.forEach( (v,k) => {\n              pass = pass && util.equals(v, expected.get(k));\n            });\n          }\n          return pass;\n        } else {\n          return undefined;\n        }\n      }\n    },\n\n    toBePromise: function() {\n      return {\n        compare: function (actual, expectedClass) {\n          var pass = typeof actual === 'object' && typeof actual.then === 'function';\n          return {\n            pass: pass,\n            get message() {\n              return 'Expected ' + actual + ' to be a promise';\n            }\n          };\n        }\n      };\n    },\n\n    toBeAnInstanceOf: function() {\n      return {\n        compare: function(actual, expectedClass) {\n          var pass = typeof actual === 'object' && actual instanceof expectedClass;\n          return {\n            pass: pass,\n            get message() {\n              return 'Expected ' + actual + ' to be an instance of ' + expectedClass;\n            }\n          };\n        }\n      };\n    },\n\n    toHaveText: function() {\n      return {\n        compare: function(actual, expectedText) {\n          var actualText = elementText(actual);\n          return {\n            pass: actualText == expectedText,\n            get message() {\n              return 'Expected ' + actualText + ' to be equal to ' + expectedText;\n            }\n          };\n        }\n      };\n    },\n\n    toImplement: function() {\n      return {\n        compare: function(actualObject, expectedInterface) {\n          var objProps = Object.keys(actualObject.constructor.prototype);\n          var intProps = Object.keys(expectedInterface.prototype);\n\n          var missedMethods = [];\n          intProps.forEach((k) => {\n            if (!actualObject.constructor.prototype[k]) missedMethods.push(k);\n          });\n\n          return {\n            pass: missedMethods.length == 0,\n            get message() {\n              return 'Expected ' + actualObject + ' to have the following methods: ' + missedMethods.join(\", \");\n            }\n          };\n        }\n      };\n    }\n  });\n});\n\nexport class SpyObject {\n  spy(name){\n    if (! this[name]) {\n      this[name] = this._createGuinnessCompatibleSpy();\n    }\n    return this[name];\n  }\n\n  rttsAssert(value) {\n    return true;\n  }\n\n  _createGuinnessCompatibleSpy(){\n    var newSpy = jasmine.createSpy();\n    newSpy.andCallFake = newSpy.and.callFake;\n    return newSpy;\n  }\n}\n\nfunction elementText(n) {\n  var hasNodes = (n) => {var children = DOM.childNodes(n); return children && children.length > 0;}\n\n  if (n instanceof Array) {\n    return n.map((nn) => elementText(nn)).join(\"\");\n  }\n\n  if (DOM.isCommentNode(n)) {\n    return '';\n  }\n\n  if (DOM.isElementNode(n) && DOM.tagName(n) == 'CONTENT') {\n    return elementText(Array.prototype.slice.apply(DOM.getDistributedNodes(n)));\n  }\n\n  if (DOM.hasShadowRoot(n)) {\n    return elementText(DOM.childNodesAsList(DOM.getShadowRoot(n)));\n  }\n\n  if (hasNodes(n)) {\n    return elementText(DOM.childNodesAsList(n));\n  }\n\n  return DOM.getText(n);\n}\n"]}