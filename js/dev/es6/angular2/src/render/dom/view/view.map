{"version":3,"sources":["view.js"],"names":[],"mappings":"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","file":"angular2/src/render/dom/view/view.es6","sourcesContent":["import {DOM} from 'angular2/src/dom/dom_adapter';\nimport {ListWrapper, MapWrapper, Map, StringMapWrapper, List} from 'angular2/src/facade/collection';\nimport {int, isPresent, isBlank, BaseException} from 'angular2/src/facade/lang';\n\nimport {ViewContainer} from './view_container';\nimport {RenderProtoView} from './proto_view';\nimport {LightDom} from '../shadow_dom/light_dom';\nimport {Content} from '../shadow_dom/content_tag';\nimport {EventManager} from 'angular2/src/render/dom/events/event_manager';\n\nimport {ShadowDomStrategy} from '../shadow_dom/shadow_dom_strategy';\n\n// import {EventDispatcher} from '../../api';\n\nconst NG_BINDING_CLASS = 'ng-binding';\n\n/**\n * Const of making objects: http://jsperf.com/instantiate-size-of-object\n */\nexport class RenderView {\n  boundElements:List;\n  boundTextNodes:List;\n  /// When the view is part of render tree, the DocumentFragment is empty, which is why we need\n  /// to keep track of the nodes.\n  rootNodes:List;\n  // TODO(tbosch): move componentChildViews, viewContainers, contentTags, lightDoms into\n  // a single array with records inside\n  componentChildViews: List<RenderView>;\n  viewContainers: List<ViewContainer>;\n  contentTags: List<Content>;\n  lightDoms: List<LightDom>;\n  proto: RenderProtoView;\n  eventManager: EventManager;\n  _hydrated: boolean;\n  _eventDispatcher: any/*EventDispatcher*/;\n  _eventHandlerRemovers: List<Function>;\n\n  constructor(\n      proto:RenderProtoView, rootNodes:List,\n      boundTextNodes: List, boundElements:List, viewContainers:List, contentTags:List, eventManager: EventManager) {\n    this.proto = proto;\n    this.rootNodes = rootNodes;\n    this.boundTextNodes = boundTextNodes;\n    this.boundElements = boundElements;\n    this.viewContainers = viewContainers;\n    this.contentTags = contentTags;\n    this.lightDoms = ListWrapper.createFixedSize(boundElements.length);\n    this.eventManager = eventManager;\n    ListWrapper.fill(this.lightDoms, null);\n    this.componentChildViews = ListWrapper.createFixedSize(boundElements.length);\n    this._hydrated = false;\n    this._eventHandlerRemovers = null;\n  }\n\n  hydrated() {\n    return this._hydrated;\n  }\n\n  setElementProperty(elementIndex:number, propertyName:string, value:any) {\n    var setter = MapWrapper.get(this.proto.elementBinders[elementIndex].propertySetters, propertyName);\n    setter(this.boundElements[elementIndex], value);\n  }\n\n  setText(textIndex:number, value:string) {\n    DOM.setText(this.boundTextNodes[textIndex], value);\n  }\n\n  setComponentView(strategy: ShadowDomStrategy,\n      elementIndex:number, childView:RenderView) {\n    var element = this.boundElements[elementIndex];\n    var lightDom = strategy.constructLightDom(this, childView, element);\n    strategy.attachTemplate(element, childView);\n    this.lightDoms[elementIndex] = lightDom;\n    this.componentChildViews[elementIndex] = childView;\n    if (this._hydrated) {\n      childView.hydrate(lightDom);\n      if (isPresent(lightDom)) {\n        lightDom.redistribute();\n      }\n    }\n  }\n\n  getViewContainer(index:number):ViewContainer {\n    return this.viewContainers[index];\n  }\n\n  _getDestLightDom(binderIndex) {\n    var binder = this.proto.elementBinders[binderIndex];\n    var destLightDom = null;\n    if (binder.parentIndex !== -1 && binder.distanceToParent === 1) {\n      destLightDom = this.lightDoms[binder.parentIndex];\n    }\n    return destLightDom;\n  }\n\n  /**\n   * A dehydrated view is a state of the view that allows it to be moved around\n   * the view tree.\n   *\n   * A dehydrated view has the following properties:\n   *\n   * - all viewcontainers are empty.\n   *\n   * A call to hydrate/dehydrate does not attach/detach the view from the view\n   * tree.\n   */\n  hydrate(hostLightDom: LightDom) {\n    if (this._hydrated) throw new BaseException('The view is already hydrated.');\n    this._hydrated = true;\n\n    // viewContainers and content tags\n    for (var i = 0; i < this.viewContainers.length; i++) {\n      var vc = this.viewContainers[i];\n      var destLightDom = this._getDestLightDom(i);\n      if (isPresent(vc)) {\n        vc.hydrate(destLightDom, hostLightDom);\n      }\n      var ct = this.contentTags[i];\n      if (isPresent(ct)) {\n        ct.hydrate(destLightDom);\n      }\n    }\n\n    // componentChildViews\n    for (var i = 0; i < this.componentChildViews.length; i++) {\n      var cv = this.componentChildViews[i];\n      if (isPresent(cv)) {\n        cv.hydrate(this.lightDoms[i]);\n      }\n    }\n\n    for (var i = 0; i < this.lightDoms.length; ++i) {\n      var lightDom = this.lightDoms[i];\n      if (isPresent(lightDom)) {\n        lightDom.redistribute();\n      }\n    }\n\n    //add global events\n    this._eventHandlerRemovers = ListWrapper.create();\n    var binders = this.proto.elementBinders;\n    for (var binderIdx = 0; binderIdx < binders.length; binderIdx++) {\n      var binder = binders[binderIdx];\n      if (isPresent(binder.globalEvents)) {\n        for (var i = 0; i < binder.globalEvents.length; i++) {\n          var globalEvent = binder.globalEvents[i];\n          var remover = this._createGlobalEventListener(binderIdx, globalEvent.name, globalEvent.target, globalEvent.fullName);\n          ListWrapper.push(this._eventHandlerRemovers, remover);\n        }\n      }\n    }\n  }\n\n  _createGlobalEventListener(elementIndex, eventName, eventTarget, fullName): Function {\n    return this.eventManager.addGlobalEventListener(eventTarget, eventName, (event) => {\n      this.dispatchEvent(elementIndex, fullName, event);\n    });\n  }\n\n  dehydrate() {\n    // Note: preserve the opposite order of the hydration process.\n\n    // componentChildViews\n    for (var i = 0; i < this.componentChildViews.length; i++) {\n      var cv = this.componentChildViews[i];\n      if (isPresent(cv)) {\n        cv.dehydrate();\n      }\n    }\n\n    // viewContainers and content tags\n    if (isPresent(this.viewContainers)) {\n      for (var i = 0; i < this.viewContainers.length; i++) {\n        var vc = this.viewContainers[i];\n        if (isPresent(vc)) {\n          vc.dehydrate();\n        }\n        var ct = this.contentTags[i];\n        if (isPresent(ct)) {\n          ct.dehydrate();\n        }\n      }\n    }\n\n    //remove global events\n    for (var i = 0; i < this._eventHandlerRemovers.length; i++) {\n      this._eventHandlerRemovers[i]();\n    }\n\n    this._eventHandlerRemovers = null;\n    this._eventDispatcher = null;\n    this._hydrated = false;\n  }\n\n  setEventDispatcher(dispatcher:any/*EventDispatcher*/) {\n    this._eventDispatcher = dispatcher;\n  }\n\n  dispatchEvent(elementIndex, eventName, event) {\n    if (isPresent(this._eventDispatcher)) {\n      var evalLocals = MapWrapper.create();\n      MapWrapper.set(evalLocals, '$event', event);\n      // TODO(tbosch): reenable this when we are parsing element properties\n      // out of action expressions\n      // var localValues = this.proto.elementBinders[elementIndex].eventLocals.eval(null, new Locals(null, evalLocals));\n      // this._eventDispatcher.dispatchEvent(elementIndex, eventName, localValues);\n      this._eventDispatcher.dispatchEvent(elementIndex, eventName, evalLocals);\n    }\n  }\n}\n"]}