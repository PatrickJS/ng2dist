{"version":3,"sources":["style_inliner_spec.js"],"names":[],"mappings":"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","file":"angular2/test/render/dom/shadow_dom/style_inliner_spec.es6","sourcesContent":["import {\n  AsyncTestCompleter,\n  beforeEach,\n  beforeEachBindings,\n  ddescribe,\n  describe,\n  el,\n  expect,\n  iit,\n  inject,\n  it,\n  xit,\n} from 'angular2/test_lib';\nimport {StyleInliner} from 'angular2/src/render/dom/shadow_dom/style_inliner';\n\nimport {isBlank} from 'angular2/src/facade/lang';\nimport {Promise, PromiseWrapper} from 'angular2/src/facade/async';\nimport {Map, MapWrapper} from 'angular2/src/facade/collection';\n\nimport {XHR} from 'angular2/src/services/xhr';\n\nimport {bind} from 'angular2/di';\n\nexport function main() {\n  describe('StyleInliner', () => {\n    beforeEachBindings(() => [\n      bind(XHR).toClass(FakeXHR),\n    ]);\n\n    describe('loading', () => {\n\n      it('should return a string when there is no import statement', inject([StyleInliner], (inliner) => {\n        var css = '.main {}';\n        var loadedCss = inliner.inlineImports(css, 'http://base');\n        expect(loadedCss).not.toBePromise();\n        expect(loadedCss).toEqual(css);\n      }));\n\n      it('should inline @import rules',\n        inject([XHR, StyleInliner, AsyncTestCompleter], (xhr, inliner, async) => {\n        xhr.reply('http://base/one.css', '.one {}');\n        var css = '@import url(\"one.css\");.main {}';\n        var loadedCss = inliner.inlineImports(css, 'http://base');\n        expect(loadedCss).toBePromise();\n        PromiseWrapper.then(\n          loadedCss,\n          function(css) {\n            expect(css).toEqual('.one {}\\n.main {}');\n            async.done();\n          },\n          function(e) {\n            throw 'fail;'\n          }\n        );\n      }));\n\n      it('should support url([unquoted url]) in @import rules',\n        inject([XHR, StyleInliner, AsyncTestCompleter], (xhr, inliner, async) => {\n        xhr.reply('http://base/one.css', '.one {}');\n        var css = '@import url(one.css);.main {}';\n        var loadedCss = inliner.inlineImports(css, 'http://base');\n        expect(loadedCss).toBePromise();\n        PromiseWrapper.then(\n          loadedCss,\n          function(css) {\n            expect(css).toEqual('.one {}\\n.main {}');\n            async.done();\n          },\n          function(e) {\n            throw 'fail;'\n          }\n        );\n      }));\n\n      it('should handle @import error gracefuly',\n        inject([StyleInliner, AsyncTestCompleter], (inliner, async) => {\n        var css = '@import \"one.css\";.main {}';\n        var loadedCss = inliner.inlineImports(css, 'http://base');\n        expect(loadedCss).toBePromise();\n        PromiseWrapper.then(\n          loadedCss,\n          function(css) {\n            expect(css).toEqual('/* failed to import http://base/one.css */\\n.main {}');\n            async.done();\n          },\n          function(e) {\n            throw 'fail;'\n          }\n        );\n      }));\n\n      it('should inline multiple @import rules',\n        inject([XHR, StyleInliner, AsyncTestCompleter], (xhr, inliner, async) => {\n        xhr.reply('http://base/one.css', '.one {}');\n        xhr.reply('http://base/two.css', '.two {}');\n        var css = '@import \"one.css\";@import \"two.css\";.main {}';\n        var loadedCss = inliner.inlineImports(css, 'http://base');\n        expect(loadedCss).toBePromise();\n        PromiseWrapper.then(\n          loadedCss,\n          function(css) {\n            expect(css).toEqual('.one {}\\n.two {}\\n.main {}');\n            async.done();\n          },\n          function(e) {\n            throw 'fail;'\n          }\n        );\n      }));\n\n      it('should inline nested @import rules',\n        inject([XHR, StyleInliner, AsyncTestCompleter], (xhr, inliner, async) => {\n        xhr.reply('http://base/one.css', '@import \"two.css\";.one {}');\n        xhr.reply('http://base/two.css', '.two {}');\n        var css = '@import \"one.css\";.main {}';\n        var loadedCss = inliner.inlineImports(css, 'http://base/');\n        expect(loadedCss).toBePromise();\n        PromiseWrapper.then(\n          loadedCss,\n          function(css) {\n            expect(css).toEqual('.two {}\\n.one {}\\n.main {}');\n            async.done();\n          },\n          function(e) {\n            throw 'fail;'\n          }\n        );\n      }));\n\n      it('should handle circular dependencies gracefuly',\n        inject([XHR, StyleInliner, AsyncTestCompleter], (xhr, inliner, async) => {\n        xhr.reply('http://base/one.css', '@import \"two.css\";.one {}');\n        xhr.reply('http://base/two.css', '@import \"one.css\";.two {}');\n        var css = '@import \"one.css\";.main {}';\n        var loadedCss = inliner.inlineImports(css, 'http://base/');\n        expect(loadedCss).toBePromise();\n        PromiseWrapper.then(\n          loadedCss,\n          function(css) {\n            expect(css).toEqual('.two {}\\n.one {}\\n.main {}');\n            async.done();\n          },\n          function(e) {\n            throw 'fail;'\n          }\n        );\n      }));\n\n      it('should handle invalid @import fracefuly',\n        inject([StyleInliner, AsyncTestCompleter], (inliner, async) => {\n        // Invalid rule: the url is not quoted\n        var css = '@import one.css;.main {}';\n        var loadedCss = inliner.inlineImports(css, 'http://base/');\n        expect(loadedCss).toBePromise();\n        PromiseWrapper.then(\n          loadedCss,\n          function(css) {\n            expect(css).toEqual('/* Invalid import rule: \"@import one.css;\" */.main {}');\n            async.done();\n          },\n          function(e) {\n            throw 'fail;'\n          }\n        );\n      }));\n    });\n\n    describe('media query', () => {\n      it('should wrap inlined content in media query',\n        inject([XHR, StyleInliner, AsyncTestCompleter], (xhr, inliner, async) => {\n        xhr.reply('http://base/one.css', '.one {}');\n        var css = '@import \"one.css\" (min-width: 700px) and (orientation: landscape);';\n        var loadedCss = inliner.inlineImports(css, 'http://base/');\n        expect(loadedCss).toBePromise();\n        PromiseWrapper.then(\n          loadedCss,\n          function(css) {\n            expect(css).toEqual('@media (min-width: 700px) and (orientation: landscape) {\\n.one {}\\n}\\n');\n            async.done();\n          },\n          function(e) {\n            throw 'fail;'\n          }\n        );\n      }));\n    });\n\n    describe('url rewritting', () => {\n      it('should rewrite url in inlined content',\n        inject([XHR, StyleInliner, AsyncTestCompleter], (xhr, inliner, async) => {\n        // it should rewrite both '@import' and 'url()'\n        xhr.reply('http://base/one.css', '@import \"./nested/two.css\";.one {background-image: url(\"one.jpg\");}');\n        xhr.reply('http://base/nested/two.css', '.two {background-image: url(\"../img/two.jpg\");}');\n        var css = '@import \"one.css\";'\n        var loadedCss = inliner.inlineImports(css, 'http://base/');\n        expect(loadedCss).toBePromise();\n        PromiseWrapper.then(\n          loadedCss,\n          function(css) {\n            expect(css).toEqual(\n              \".two {background-image: url('http://base/img/two.jpg');}\\n\" +\n              \".one {background-image: url('http://base/one.jpg');}\\n\"\n            );\n            async.done();\n          },\n          function(e) {\n            throw 'fail;'\n          }\n        );\n      }));\n    });\n  });\n}\n\nclass FakeXHR extends XHR {\n  _responses: Map;\n\n  constructor() {\n    super();\n    this._responses = MapWrapper.create();\n  }\n\n  get(url: string): Promise<string> {\n    var response = MapWrapper.get(this._responses, url);\n    if (isBlank(response)) {\n      return PromiseWrapper.reject('xhr error');\n    }\n\n    return PromiseWrapper.resolve(response);\n  }\n\n  reply(url: string, response: string) {\n    MapWrapper.set(this._responses, url, response);\n  }\n}\n"]}