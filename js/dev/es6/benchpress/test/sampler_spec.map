{"version":3,"sources":["sampler_spec.js"],"names":[],"mappings":"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","file":"benchpress/test/sampler_spec.es6","sourcesContent":["import {\n  afterEach,\n  AsyncTestCompleter,\n  beforeEach,\n  ddescribe,\n  describe,\n  expect,\n  iit,\n  inject,\n  it,\n  xit,\n} from 'angular2/test_lib';\n\nimport { isBlank, isPresent, BaseException, stringify, Date, DateWrapper } from 'angular2/src/facade/lang';\nimport { ListWrapper, List } from 'angular2/src/facade/collection';\nimport { PromiseWrapper, Promise } from 'angular2/src/facade/async';\n\nimport {\n  Sampler, WebDriverAdapter, WebDriverExtension,\n  Validator, Metric, Reporter, Browser,\n  bind, Injector, Options, MeasureValues\n} from 'benchpress/common';\n\nexport function main() {\n  var EMPTY_EXECUTE = () => {};\n\n  describe('sampler', () => {\n    var sampler;\n\n    function createSampler({\n      driver,\n      driverExtension,\n      metric,\n      reporter,\n      validator,\n      forceGc,\n      prepare,\n      execute\n    } = {}) {\n      var time = 1000;\n      if (isBlank(metric)) {\n        metric = new MockMetric([]);\n      }\n      if (isBlank(reporter)) {\n        reporter = new MockReporter([]);\n      }\n      if (isBlank(driver)) {\n        driver = new MockDriverAdapter([]);\n      }\n      if (isBlank(driverExtension)) {\n        driverExtension = new MockDriverExtension([]);\n      }\n      var bindings = [\n        Options.DEFAULT_BINDINGS,\n        Sampler.BINDINGS,\n        bind(Metric).toValue(metric),\n        bind(Reporter).toValue(reporter),\n        bind(WebDriverAdapter).toValue(driver),\n        bind(WebDriverExtension).toValue(driverExtension),\n        bind(Options.EXECUTE).toValue(execute),\n        bind(Validator).toValue(validator),\n        bind(Options.NOW).toValue( () => DateWrapper.fromMillis(time++) )\n      ];\n      if (isPresent(prepare)) {\n        ListWrapper.push(bindings, bind(Options.PREPARE).toValue(prepare));\n      }\n      if (isPresent(forceGc)) {\n        ListWrapper.push(bindings, bind(Options.FORCE_GC).toValue(forceGc));\n      }\n\n      sampler = Injector.resolveAndCreate(bindings).get(Sampler);\n    }\n\n    it('should call the prepare and execute callbacks using WebDriverAdapter.waitFor', inject([AsyncTestCompleter], (async) => {\n      var log = [];\n      var count = 0;\n      var driver = new MockDriverAdapter([], (callback) => {\n        var result = callback();\n        ListWrapper.push(log, result);\n        return PromiseWrapper.resolve(result);\n      });\n      createSampler({\n        driver: driver,\n        validator: createCountingValidator(2),\n        prepare: () => {\n          return count++;\n        },\n        execute: () => {\n          return count++;\n        }\n      });\n      sampler.sample().then( (_) => {\n        expect(count).toBe(4);\n        expect(log).toEqual([0,1,2,3]);\n        async.done();\n      });\n\n    }));\n\n    it('should call prepare, gc, beginMeasure, execute, gc, endMeasure for every iteration', inject([AsyncTestCompleter], (async) => {\n      var workCount = 0;\n      var log = [];\n      createSampler({\n        forceGc: true,\n        metric: createCountingMetric(log),\n        driverExtension: new MockDriverExtension(log),\n        validator: createCountingValidator(2),\n        prepare: () => {\n          ListWrapper.push(log, `p${workCount++}`);\n        },\n        execute: () => {\n          ListWrapper.push(log, `w${workCount++}`);\n        }\n      });\n      sampler.sample().then( (_) => {\n        expect(log).toEqual([\n          ['gc'],\n          'p0',\n          ['gc'],\n          ['beginMeasure'],\n          'w1',\n          ['gc'],\n          ['endMeasure', false, {'script': 0}],\n          'p2',\n          ['gc'],\n          ['beginMeasure'],\n          'w3',\n          ['gc'],\n          ['endMeasure', false, {'script': 1}],\n        ]);\n        async.done();\n      });\n    }));\n\n    it('should call execute, gc, endMeasure for every iteration if there is no prepare callback', inject([AsyncTestCompleter], (async) => {\n      var log = [];\n      var workCount = 0;\n      createSampler({\n        forceGc: true,\n        metric: createCountingMetric(log),\n        driverExtension: new MockDriverExtension(log),\n        validator: createCountingValidator(2),\n        execute: () => {\n          ListWrapper.push(log, `w${workCount++}`);\n        },\n        prepare: null\n      });\n      sampler.sample().then( (_) => {\n        expect(log).toEqual([\n          ['gc'],\n          ['beginMeasure'],\n          'w0',\n          ['gc'],\n          ['endMeasure', true, {'script': 0}],\n          'w1',\n          ['gc'],\n          ['endMeasure', true, {'script': 1}],\n        ]);\n        async.done();\n      });\n    }));\n\n    it('should not gc if the flag is not set', inject([AsyncTestCompleter], (async) => {\n      var log = [];\n      createSampler({\n        metric: createCountingMetric(),\n        driverExtension: new MockDriverExtension(log),\n        validator: createCountingValidator(2),\n        prepare: EMPTY_EXECUTE,\n        execute: EMPTY_EXECUTE\n      });\n      sampler.sample().then( (_) => {\n        expect(log).toEqual([]);\n        async.done();\n      });\n    }));\n\n    it('should only collect metrics for execute and ignore metrics from prepare', inject([AsyncTestCompleter], (async) => {\n      var scriptTime = 0;\n      var iterationCount = 1;\n      createSampler({\n        validator: createCountingValidator(2),\n        metric: new MockMetric([], () => {\n          var result = PromiseWrapper.resolve({'script': scriptTime});\n          scriptTime = 0;\n          return result;\n        }),\n        prepare: () => {\n          scriptTime = 1 * iterationCount;\n        },\n        execute: () => {\n          scriptTime = 10 * iterationCount;\n          iterationCount++;\n        }\n      });\n      sampler.sample().then( (state) => {\n        expect(state.completeSample.length).toBe(2);\n        expect(state.completeSample[0]).toEqual(mv(0, 1000, {'script': 10}));\n        expect(state.completeSample[1]).toEqual(mv(1, 1001, {'script': 20}));\n        async.done();\n      });\n    }));\n\n    it('should call the validator for every execution and store the valid sample', inject([AsyncTestCompleter], (async) => {\n      var log = [];\n      var validSample = [{}];\n\n      createSampler({\n        metric: createCountingMetric(),\n        validator: createCountingValidator(2, validSample, log),\n        execute: EMPTY_EXECUTE\n      });\n      sampler.sample().then( (state) => {\n        expect(state.validSample).toBe(validSample);\n        // TODO(tbosch): Why does this fail??\n        // expect(log).toEqual([\n        //   ['validate', [{'script': 0}], null],\n        //   ['validate', [{'script': 0}, {'script': 1}], validSample]\n        // ]);\n\n        expect(log.length).toBe(2);\n        expect(log[0]).toEqual(\n          ['validate', [mv(0, 1000, {'script': 0})], null]\n        );\n        expect(log[1]).toEqual(\n          ['validate', [mv(0, 1000, {'script': 0}), mv(1, 1001, {'script': 1})], validSample]\n        );\n\n        async.done();\n      });\n    }));\n\n    it('should report the metric values', inject([AsyncTestCompleter], (async) => {\n      var log = [];\n      var validSample = [{}];\n      createSampler({\n        validator: createCountingValidator(2, validSample),\n        metric: createCountingMetric(),\n        reporter: new MockReporter(log),\n        execute: EMPTY_EXECUTE\n      });\n      sampler.sample().then( (_) => {\n        // TODO(tbosch): Why does this fail??\n        // expect(log).toEqual([\n        //   ['reportMeasureValues', 0, {'script': 0}],\n        //   ['reportMeasureValues', 1, {'script': 1}],\n        //   ['reportSample', [{'script': 0}, {'script': 1}], validSample]\n        // ]);\n        expect(log.length).toBe(3);\n        expect(log[0]).toEqual(\n          ['reportMeasureValues', mv(0, 1000, {'script': 0})]\n        );\n        expect(log[1]).toEqual(\n          ['reportMeasureValues', mv(1, 1001, {'script': 1})]\n        );\n        expect(log[2]).toEqual(\n          ['reportSample', [mv(0, 1000, {'script': 0}), mv(1, 1001, {'script': 1})], validSample]\n        );\n\n        async.done();\n      });\n    }));\n\n  });\n}\n\nfunction mv(runIndex, time, values) {\n  return new MeasureValues(runIndex, DateWrapper.fromMillis(time), values);\n}\n\nfunction createCountingValidator(count, validSample = null, log = null) {\n  return new MockValidator(log, (completeSample) => {\n    count--;\n    if (count === 0) {\n      return isPresent(validSample) ? validSample : completeSample;\n    } else {\n      return null;\n    }\n  });\n}\n\nfunction createCountingMetric(log = null) {\n  var scriptTime = 0;\n  return new MockMetric(log, () => {\n    return { 'script': scriptTime++ };\n  });\n}\n\nclass MockDriverAdapter extends WebDriverAdapter {\n  _log:List;\n  _waitFor:Function;\n  constructor(log = null, waitFor = null) {\n    super();\n    if (isBlank(log)) {\n      log = [];\n    }\n    this._log = log;\n    this._waitFor = waitFor;\n  }\n  waitFor(callback:Function):Promise {\n    if (isPresent(this._waitFor)) {\n      return this._waitFor(callback);\n    } else {\n      return PromiseWrapper.resolve(callback());\n    }\n  }\n}\n\n\nclass MockDriverExtension extends WebDriverExtension {\n  _log:List;\n  constructor(log = null) {\n    super();\n    if (isBlank(log)) {\n      log = [];\n    }\n    this._log = log;\n  }\n  gc():Promise {\n    ListWrapper.push(this._log, ['gc']);\n    return PromiseWrapper.resolve(null);\n  }\n}\n\nclass MockValidator extends Validator {\n  _validate:Function;\n  _log:List;\n  constructor(log = null, validate = null) {\n    super();\n    this._validate = validate;\n    if (isBlank(log)) {\n      log = [];\n    }\n    this._log = log;\n  }\n  validate(completeSample:List<MeasureValues>):List<MeasureValues> {\n    var stableSample = isPresent(this._validate) ? this._validate(completeSample) : completeSample;\n    ListWrapper.push(this._log, ['validate', completeSample, stableSample]);\n    return stableSample;\n  }\n}\n\nclass MockMetric extends Metric {\n  _endMeasure:Function;\n  _log:List;\n  constructor(log = null, endMeasure = null) {\n    super();\n    this._endMeasure = endMeasure;\n    if (isBlank(log)) {\n      log = [];\n    }\n    this._log = log;\n  }\n  beginMeasure() {\n    ListWrapper.push(this._log, ['beginMeasure']);\n    return PromiseWrapper.resolve(null);\n  }\n  endMeasure(restart) {\n    var measureValues = isPresent(this._endMeasure) ? this._endMeasure() : {};\n    ListWrapper.push(this._log, ['endMeasure', restart, measureValues]);\n    return PromiseWrapper.resolve(measureValues);\n  }\n}\n\nclass MockReporter extends Reporter {\n  _log:List;\n  constructor(log = null) {\n    super();\n    if (isBlank(log)) {\n      log = [];\n    }\n    this._log = log;\n  }\n  reportMeasureValues(values):Promise {\n    ListWrapper.push(this._log, ['reportMeasureValues', values]);\n    return PromiseWrapper.resolve(null);\n  }\n  reportSample(completeSample, validSample):Promise {\n    ListWrapper.push(this._log, ['reportSample', completeSample, validSample]);\n    return PromiseWrapper.resolve(null);\n  }\n}\n"]}